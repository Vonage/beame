(()=>{var __webpack_modules__={989:(e,r,a)=>{const t=a(213),o=a(866),{pipeline:n,PassThrough:_}=a(413),{pipe:s,filter:i,get:l,map:c,orderBy:p,equals:u}=a(114);const d=4,m="6.0-preview";e.exports=function({ga_api_base_url:e,ga_api_token:r,ga_run_id:a,artifact_name:n}){const d=new _;const f=`${e}_apis/pipelines/workflows/${a}/artifacts`;const ghaStreamClient=e=>o.fromNodeCallback((a=>{t({throwHttpErrors:true,...e,headers:{Accept:`application/json;api-version=${m}`,Authorization:`Bearer ${r}`,...e["headers"]||{}}}).then(a.bind(null,null),a)}));ghaStreamClient({url:f,searchParams:{artifactName:n},resolveBodyOnly:true,responseType:"json"}).map(l("value.0.fileContainerResourceUrl")).flatMap((e=>ghaStreamClient({url:e,resolveBodyOnly:true,responseType:"json"}))).flatten(s(l("value"),i(s(l("itemType"),u("file"))),p([s(l("path"),(e=>+e.match(/([0-9]+)\.bin$/)[1]))],["asc"]),c(l("contentLocation")))).flatMapConcat((e=>ghaStreamClient({url:e,resolveBodyOnly:true,responseType:"buffer",headers:{Accept:`application/octet-stream;api-version=${m}`}}))).onValue((e=>d.write(e))).onEnd((()=>d.end()));return d}},112:(e,r,a)=>{const t=a(866),{Glob:o}=a(897),n=a(20),{createGzip:_}=a(761),{pipeline:s}=a(413),{createReadStream:i,stat:l}=a(747),{join:c}=a(622),{always:p,get:u,noop:d}=a(114);e.exports=function({globs:e=[],base_folder:r}){const a=n.pack(),m=s(a,_(),d);t.merge([].concat(e).map((e=>{const a=new o(e,{cwd:r,nodir:true});return t.fromEvents(a,"match").takeUntilBy(t.fromEvents(a,"end"))}))).flatMapConcat((e=>{const o=c(r,e);return t.fromNodeCallback((e=>l(o,e))).map(u("size")).flatMap((r=>t.fromPromise(new Promise(((t,n)=>{s(i(o,{autoClose:true,emitClose:true}),a.entry({name:e,size:r}),((e,r)=>(e?n:t)(e||r)))}))))).map(p(e))})).takeErrors(1).onEnd((()=>a.finalize()));return m}},406:(e,r,a)=>{const t=a(213),o=a(866),{pipeline:n}=a(413),{noop:_,always:s}=a(114),i=a(712);const l=1024*1024,c=4*l,p=4,u="6.0-preview";e.exports=function({ga_api_base_url:e,ga_api_token:r,ga_run_id:a,artifact_name:l,artifact_stream:d}){const m=`${e}_apis/pipelines/workflows/${a}/artifacts`;const ghaStreamClient=e=>o.fromNodeCallback((a=>{t({throwHttpErrors:true,...e,headers:{Accept:`application/json;api-version=${u}`,Authorization:`Bearer ${r}`,...e["headers"]||{}}}).then(a.bind(null,null),a)}));return ghaStreamClient({resolveBodyOnly:true,responseType:"json",method:"POST",url:m,json:{Type:"actions_storage",Name:l}}).flatMap((({fileContainerResourceUrl:e})=>{let r=0,a=0;const t=n(d,i(c,{flush:true}),_);return o.concat([o.fromEvents(t,"data").merge(o.fromEvents(t,"error").flatMap(o.constantError)).takeUntilBy(o.fromEvents(t,"end").take(1)).flatMapConcurLimit((t=>{a+=t.length;return ghaStreamClient({resolveBodyOnly:true,responseType:"json",url:e,headers:{"content-type":"application/octet-stream","content-length":t.length,"content-range":`bytes 0-${t.length-1}/${t.length}`,connection:"Keep-Alive","Keep-Alive":"10"},method:"PUT",searchParams:{itemPath:`/${l}/${["part",r++].join("_")}.bin`},body:t})}),p),ghaStreamClient({url:m,method:"PATCH",json:{Size:a},searchParams:{artifactName:l},resolveBodyOnly:true,responseType:"json"})])})).beforeEnd(s(true)).takeErrors(1).toPromise()}},450:module=>{module.exports=eval("require")("@actions/core")},897:module=>{module.exports=eval("require")("glob")},213:module=>{module.exports=eval("require")("got")},866:module=>{module.exports=eval("require")("kefir")},114:module=>{module.exports=eval("require")("lodash/fp")},712:module=>{module.exports=eval("require")("stream-chunker")},20:module=>{module.exports=eval("require")("tar-stream")},747:e=>{"use strict";e.exports=require("fs")},622:e=>{"use strict";e.exports=require("path")},413:e=>{"use strict";e.exports=require("stream")},761:e=>{"use strict";e.exports=require("zlib")}};var __webpack_module_cache__={};function __nccwpck_require__(e){var r=__webpack_module_cache__[e];if(r!==undefined){return r.exports}var a=__webpack_module_cache__[e]={exports:{}};var t=true;try{__webpack_modules__[e](a,a.exports,__nccwpck_require__);t=false}finally{if(t)delete __webpack_module_cache__[e]}return a.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var __webpack_exports__={};(()=>{const{pipeline:e}=__nccwpck_require__(413),r=__nccwpck_require__(450),a=__nccwpck_require__(406),t=__nccwpck_require__(989),o=__nccwpck_require__(112),n=__nccwpck_require__(866),_=__nccwpck_require__(20),{createGunzip:s}=__nccwpck_require__(761),{noop:i}=__nccwpck_require__(114),{createWriteStream:l,mkdir:c}=__nccwpck_require__(747),{join:p,dirname:u}=__nccwpck_require__(622);const[d,m,f,b]=["direction","pattern","folder","artifact"].map((e=>r.getInput(e)));const[k,g,h]=["ACTIONS_RUNTIME_URL","ACTIONS_RUNTIME_TOKEN","GITHUB_RUN_ID"].map((e=>process.env[e]));const beamUp=function({base_folder:e,file_pattern:r,artifact_name:t,ga_api_base_url:n,ga_api_token:_,ga_run_id:s}){a({ga_api_base_url:n,ga_api_token:_,ga_run_id:s,artifact_name:t,artifact_stream:o({globs:[r],base_folder:e})}).then((()=>console.log("Uploaded successfully!"))).catch(console.error)};const beamDown=function({base_folder:r,artifact_name:a,ga_api_base_url:o,ga_api_token:d,ga_run_id:m}){const f=e(t({ga_api_base_url:o,ga_api_token:d,ga_run_id:m,artifact_name:a}),s(),_.extract(),i);f.on("entry",(function(a,t,o){t.once("end",o);n.concat([n.fromNodeCallback((e=>c(p(r,u(a.name)),{recursive:true},e))),n.fromNodeCallback((o=>{e(t,l(p(r,a.name)),o)}))]).onError((()=>console.error(a.name))).onValue((()=>console.log(a.name)))}));f.on("end",(()=>process.exit()))};({up:beamUp,down:beamDown}[d]||function(){console.error(`direction "${d}" is unsupported`)})({base_folder:f,file_pattern:m,artifact_name:b,ga_api_base_url:k,ga_api_token:g,ga_run_id:h})})();module.exports=__webpack_exports__})();